<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="simhelpers">
<title>Simulation Performance Criteria and MCSE • simhelpers</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation Performance Criteria and MCSE">
<meta property="og:description" content="simhelpers">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">simhelpers</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MCSE.html">Simulation Performance Criteria and MCSE</a>
    <a class="dropdown-item" href="../articles/simulation_workflow.html">Simulation Workflow</a>
    <a class="dropdown-item" href="../articles/visualization.html">Presenting Results from Simulation Studies</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/meghapsimatrix/simhelpers/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="MCSE_files/kePrint-0.0.1/kePrint.js"></script><link href="MCSE_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulation Performance Criteria and MCSE</h1>
            
            <h4 data-toc-skip class="date">2024-02-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/meghapsimatrix/simhelpers/blob/HEAD/vignettes/MCSE.Rmd" class="external-link"><code>vignettes/MCSE.Rmd</code></a></small>
      <div class="d-none name"><code>MCSE.Rmd</code></div>
    </div>

    
    
<p>Monte Carlo simulations are computer experiments designed to study
the performance of statistical methods under known data-generating
conditions <span class="citation">(Morris, White, &amp; Crowther,
2019)</span>. Methodologists use simulations to examine questions such
as: (1) how does ordinary least squares (OLS) regression perform if
errors are heteroskedastic? (2) how does the presence of missing data
affect treatment effect estimates from a propensity score analysis? (3)
how does cluster robust variance estimation perform when the number of
clusters is small? To answer such questions, we conduct experiments by
simulating thousands of datasets based on pseudo-random sampling <span class="citation">(Morris et al., 2019)</span>. We generate datasets
under known conditions. For example, we can generate data where the
errors are heteroskedastic or there is missing data present following
Missing at Random (MAR) mechanism. Then, we apply statistical methods,
like OLS or propensity score estimation using logistic regression, to
each of the datasets and extract results like regression coefficients,
p-values, and confidence intervals. We then analyze the performance of
these estimation methods using criteria such as bias, Type 1 error rate,
or root mean squared error. Performance measures from simulation studies
are estimates, based on a finite number of repeated samples from a
data-generating process, and thus include some random error. When
interpreting performance measures, it is important to consider how large
the estimation error is. This is typically quantified as Monte Carlo
standard error (MCSE).</p>
<p>The goal of <code>simhelpers</code> is to assist in running
simulation studies. This package provides a set of functions that
calculate various performance measures and associated MCSE. This
vignette focuses on the set of functions for calculating performance
measures. Below, we explain three major categories of performance
criteria: (1) absolute criteria, (2) relative criteria, and (3) criteria
to evaluate hypothesis testing. We provide formulas used to calculate
the performance measures and MCSE and demonstrate how to use the
functions in the <code>simhelpers</code> package.</p>
<p>The notation and explanations of the performance measures largely
follow notes from Dr. James Pustejovsky’s <a href="https://www.jepusto.com/teaching/daspir/" class="external-link">Data Analysis,
Simulation and Programming in R course (Spring, 2019)</a>.</p>
<div class="section level2">
<h2 id="performance-criteria-and-mcse">Performance Criteria and MCSE<a class="anchor" aria-label="anchor" href="#performance-criteria-and-mcse"></a>
</h2>
<div class="section level3">
<h3 id="absolute-criteria">Absolute Criteria<a class="anchor" aria-label="anchor" href="#absolute-criteria"></a>
</h3>
<p>Bias characterizes whether an estimator tends to lie above or below
the true parameter, on average. Variance characterizes the precision of
an estimator, as the average squared deviation of the estimator from its
average. Note that variance is the inverse of precision. Therefore, the
higher the variance, the lower the precision. Mean squared error (MSE)
and root mean squared error (RMSE) characterize the accuracy of the
estimates. MSE and RMSE measure how far off, on average, an estimator is
from the true parameter. Absolute criteria are in the same scale as the
estimate. MSE is in squared deviation scale and RMSE is in the scale of
the estimates.</p>
<p>Let <span class="math inline">\(T\)</span> denote an estimator for a
parameter <span class="math inline">\(\theta\)</span>. By running a
simulation study, we obtain <span class="math inline">\(K\)</span>
estimates <span class="math inline">\(T_1,...,T_K\)</span> (or
realizations of the estimator) for each data generating condition. We
can calculate the following sample statistics for the estimates:</p>
<ul>
<li>Sample mean: <span class="math inline">\(\bar{T} =
\frac{1}{K}\sum_{k=1}^K T_k\)</span>
</li>
<li>Sample variance: <span class="math inline">\(S_T^2 = \frac{1}{K -
1}\sum_{k=1}^K \left(T_k - \bar{T}\right)^2\)</span>
</li>
<li>Sample skewness (standardized): <span class="math inline">\(g_T =
\frac{1}{K S_T^3}\sum_{k=1}^K \left(T_k - \bar{T}\right)^3\)</span>
</li>
<li>Sample kurtosis (standardized): <span class="math inline">\(k_T =
\frac{1}{K S_T^4} \sum_{k=1}^K \left(T_k -
\bar{T}\right)^4\)</span>
</li>
</ul>
<p>Table 1 below shows each of the performance criteria, its
interpretation, its formal definition, how the criterion is estimated in
a simulation study, and the formula for the MCSE of the estimated
performance measure.</p>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Table 1. Absolute Performance Criteria
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Bias
</td>
<td style="text-align:left;">
Difference from true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(T) - \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{T} - \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{S_T^2/ K}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Variance
</td>
<td style="text-align:left;">
Precision
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(T -
\text{E}(T))^2\right]\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(S_T^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(S_T^2 \sqrt{\frac{k_T - 1}{K}}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
MSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(T - \theta)^2\right]\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{1}{K}\sum_{k=1}^{K}\left(T_k -
\theta\right)^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K}\left[S_T^4 (k_T - 1) + 4
S_T^3 g_T(\bar{T} - \theta) + 4 S_T^2 (\bar{T} -
\theta)^2\right]}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\text{E}\left[(T -
\theta)^2\right]}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K}\sum_{k=1}^{K}\left(T_k -
\theta\right)^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{K - 1}{K} \sum_{j=1}^K
\left(RMSE_{(j)} - RMSE\right)^2}\)</span>
</td>
</tr>
</tbody>
</table>
<p>The equation for the MCSE of RMSE is derived using the jack-knife
technique, which involves excluding a replicate <span class="math inline">\(j\)</span> and calculating RMSE <span class="citation">(Efron &amp; Stein, 1981)</span>. The formula for RMSE
is:</p>
<p><span class="math display">\[\sqrt{\frac{1}{K}\sum_{k=1}^{K}\left(T_k
- \theta\right)^2}\]</span></p>
<p>This is approximately equivalent to:</p>
<p><span class="math display">\[RMSE = \sqrt{(\bar{T} - \theta)^2 +
S^2_T}\]</span></p>
<p>The jack-knife RMSE will be calculated as:</p>
<p><span class="math display">\[RMSE_{(j)}  = \sqrt{(\bar{T}_{(j)} -
\theta)^2 + S^2_{T(j)}}\]</span></p>
<p>Here <span class="math inline">\(\bar{T}_{(j)}\)</span> and <span class="math inline">\(S^2_{T(j)}\)</span> indicate the mean and variance
of the estimates leaving out replicate <span class="math inline">\(j\)</span>. Instead of calculating each jack-knife
estimate, we use algebraic tricks to calculate <span class="math inline">\(\bar{T}_{(j)}\)</span> and <span class="math inline">\(S^2_{T(j)}\)</span> as follows:</p>
<p><span class="math display">\[\bar{T}_{(j)} = \frac{1}{K-1} \left(K
\bar{T} - T_j\right)\]</span></p>
<p><span class="math display">\[S_{T(j)}^2 = \frac{1}{K - 2} \left[(K -
1) S_T^2 - \frac{K}{K - 1}\left(T_j -
\bar{T}\right)^2\right]\]</span></p>
<p>Then, the jack-knife MCSE of RMSE will be calculated as:</p>
<p><span class="math display">\[MCSE_{RMSE(JK)}  = \sqrt{\frac{K
-1}{K}\sum_{j=1}^K  \left(RMSE_{(j)} - RMSE\right)^2}\]</span></p>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>We use the <code>welch_res</code> dataset included in the package. It
contains the results from an example simulation study comparing the
heteroskedasticity-robust Welch t-test to the usual two-sample t-test
assuming equal variances. The code used to generate the data and derive
results can be found <a href="https://github.com/meghapsimatrix/simhelpers/blob/master/data-raw/welch_res_dat.R" class="external-link">here</a>.
We varied the sample sizes per group. We set the sample size of Group 1
to 50 and we varied sample size of Group 2 to be 50 and 70. We varied
the mean difference parameter when generating data for two groups. We
set the values to 0, 0.5, 1 and 2. We generated the data with slightly
unequal variances. With each simulated dataset, we ran the usual t-test,
which assumes homogeneity of variance, and we also ran Welch t-test,
which does not assume homogeneity of variance. We extracted the
estimates (mean differences), variances of the estimates, p-values, and
the lower and upper bounds of the confidence intervals.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://meghapsimatrix.github.io/simhelpers/index.html">simhelpers</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 16,000</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ n1          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50…</span></span>
<span><span class="co">#&gt; $ n2          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50…</span></span>
<span><span class="co">#&gt; $ mean_diff   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ iterations  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000…</span></span>
<span><span class="co">#&gt; $ seed        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 204809087, 204809087, 204809087, 204809087, 204809087, 204…</span></span>
<span><span class="co">#&gt; $ method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "t-test", "Welch t-test", "t-test", "Welch t-test", "t-tes…</span></span>
<span><span class="co">#&gt; $ est         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.025836000, 0.025836000, 0.005158587, 0.005158587, -0.079…</span></span>
<span><span class="co">#&gt; $ var         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.09543914, 0.09543914, 0.08481717, 0.08481717, 0.08179330…</span></span>
<span><span class="co">#&gt; $ p_val       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.9335212, 0.9335804, 0.9859039, 0.9859109, 0.7807543, 0.7…</span></span>
<span><span class="co">#&gt; $ lower_bound <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -0.5872300, -0.5899041, -0.5727856, -0.5741984, -0.6473703…</span></span>
<span><span class="co">#&gt; $ upper_bound <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.6389020, 0.6415761, 0.5831027, 0.5845155, 0.4877263, 0.4…</span></span></code></pre></div>
<p>Below, we calculate the absolute performance criteria for the
estimates of the mean differences. We present the results by sample
sizes, mean difference, and the t-test method. The
<code><a href="../reference/calc_absolute.html">calc_absolute()</a></code> function is designed to work with the <a href="https://tidyeval.tidyverse.org/index.html" class="external-link"><code>tidyeval</code></a>
workflow <span class="citation">(Wickham et al., 2019)</span>. The first
argument, <code>res_dat</code>, requires a data frame or a tibble
containing the results from a simulation study. The second argument,
<code>estimates</code>, requires the name of the column containing the
estimates like mean difference or regression coefficients. The third
argument, <code>true_param</code>, requires the name of the column
containing the true parameters. The fourth argument,
<code>perfm_criteria</code>, lets the user specify which criteria to
evaluate. The criteria can be specified using a character or character
vector. If the user only wants bias, they can specify
<code>perfm_criteria = "bias"</code>. If the user wants bias and root
mean squared error, they can specify
<code>perfm_criteria = c("bias", "rmse")</code>. By default, the
function returns bias, variance, mean squared error (mse), and root mean
squared error (rmse),
<code>perfm_criteria = c("bias", "variance", "mse", "rmse")</code>. In
the example below, we ask for all the available criteria.</p>
<p>We calculate the absolute performance measures only for the
conventional t-test results because the mean difference is identical for
the Welch t-test. We use <a href="https://dplyr.tidyverse.org/index.html" class="external-link"><code>dplyr</code></a>
syntax to group by the sample sizes and mean difference that were used
to generate the data. We provide examples using <a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link"><code>do()</code></a>
and <a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link"><code>group_modify()</code></a>
to run <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code> on results for each combination of
the conditions. Results are rounded to five decimal places.</p>
<p>If there are any convergence issues with estimation, please make sure
to <a href="https://meghapsimatrix.github.io/simhelpers/articles/simulation_workflow.html#convergence-issues">write
your estimation function to output <code>NA</code> for the values of the
point estimates, variance estimates, p-values, or confidence interval
estimates</a>. The functions in the <code>simhelpers</code> package will
calculate performance criteria and MCSE after deleting any missing
estimates and will output the number of iterations, <code>K</code>,
which will exclude iterations with <code>NA</code> values for estimates.
Note that <code>K</code> may differ by condition.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using do()</span></span>
<span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"t-test"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># filter just conventional t-test res</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">mean_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># grouping </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">do</a></span><span class="op">(</span><span class="fu"><a href="../reference/calc_absolute.html">calc_absolute</a></span><span class="op">(</span><span class="va">.</span>, estimates <span class="op">=</span> <span class="va">est</span>, true_param <span class="op">=</span> <span class="va">mean_diff</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># run the function</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># create a kable table </span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="3%">
<col width="10%">
<col width="5%">
<col width="9%">
<col width="10%">
<col width="8%">
<col width="9%">
<col width="8%">
<col width="9%">
<col width="8%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">mean_diff</th>
<th align="right">K</th>
<th align="right">bias</th>
<th align="right">bias_mcse</th>
<th align="right">var</th>
<th align="right">var_mcse</th>
<th align="right">mse</th>
<th align="right">mse_mcse</th>
<th align="right">rmse</th>
<th align="right">rmse_mcse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="right">1000</td>
<td align="right">-0.00890</td>
<td align="right">0.01000</td>
<td align="right">0.09999</td>
<td align="right">0.00425</td>
<td align="right">0.09997</td>
<td align="right">0.00425</td>
<td align="right">0.31618</td>
<td align="right">0.00839</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="right">1000</td>
<td align="right">-0.00555</td>
<td align="right">0.01034</td>
<td align="right">0.10698</td>
<td align="right">0.00473</td>
<td align="right">0.10690</td>
<td align="right">0.00473</td>
<td align="right">0.32696</td>
<td align="right">0.00891</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="right">1000</td>
<td align="right">-0.00726</td>
<td align="right">0.00988</td>
<td align="right">0.09766</td>
<td align="right">0.00423</td>
<td align="right">0.09761</td>
<td align="right">0.00423</td>
<td align="right">0.31243</td>
<td align="right">0.00840</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="right">1000</td>
<td align="right">0.00725</td>
<td align="right">0.00981</td>
<td align="right">0.09631</td>
<td align="right">0.00440</td>
<td align="right">0.09627</td>
<td align="right">0.00439</td>
<td align="right">0.31028</td>
<td align="right">0.00862</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="right">1000</td>
<td align="right">-0.00266</td>
<td align="right">0.00867</td>
<td align="right">0.07521</td>
<td align="right">0.00330</td>
<td align="right">0.07514</td>
<td align="right">0.00331</td>
<td align="right">0.27411</td>
<td align="right">0.00744</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="right">1000</td>
<td align="right">-0.00514</td>
<td align="right">0.00895</td>
<td align="right">0.08002</td>
<td align="right">0.00391</td>
<td align="right">0.07997</td>
<td align="right">0.00391</td>
<td align="right">0.28278</td>
<td align="right">0.00826</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="right">1000</td>
<td align="right">-0.01124</td>
<td align="right">0.00899</td>
<td align="right">0.08081</td>
<td align="right">0.00358</td>
<td align="right">0.08086</td>
<td align="right">0.00358</td>
<td align="right">0.28435</td>
<td align="right">0.00775</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="right">1000</td>
<td align="right">-0.00079</td>
<td align="right">0.00883</td>
<td align="right">0.07805</td>
<td align="right">0.00345</td>
<td align="right">0.07798</td>
<td align="right">0.00345</td>
<td align="right">0.27924</td>
<td align="right">0.00760</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using group_modify()</span></span>
<span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"t-test"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># filter just conventional t-test res</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">mean_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># group_modify cannot take in a group column as an argument</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">mean_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># grouping </span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/calc_absolute.html">calc_absolute</a></span><span class="op">(</span><span class="va">.x</span>, estimates <span class="op">=</span> <span class="va">est</span>, true_param <span class="op">=</span> <span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="3%">
<col width="10%">
<col width="5%">
<col width="9%">
<col width="10%">
<col width="8%">
<col width="9%">
<col width="8%">
<col width="9%">
<col width="8%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">mean_diff</th>
<th align="right">K</th>
<th align="right">bias</th>
<th align="right">bias_mcse</th>
<th align="right">var</th>
<th align="right">var_mcse</th>
<th align="right">mse</th>
<th align="right">mse_mcse</th>
<th align="right">rmse</th>
<th align="right">rmse_mcse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="right">1000</td>
<td align="right">-0.00890</td>
<td align="right">0.01000</td>
<td align="right">0.09999</td>
<td align="right">0.00425</td>
<td align="right">0.09997</td>
<td align="right">0.00425</td>
<td align="right">0.31618</td>
<td align="right">0.00839</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="right">1000</td>
<td align="right">-0.00555</td>
<td align="right">0.01034</td>
<td align="right">0.10698</td>
<td align="right">0.00473</td>
<td align="right">0.10690</td>
<td align="right">0.00473</td>
<td align="right">0.32696</td>
<td align="right">0.00891</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="right">1000</td>
<td align="right">-0.00726</td>
<td align="right">0.00988</td>
<td align="right">0.09766</td>
<td align="right">0.00423</td>
<td align="right">0.09761</td>
<td align="right">0.00423</td>
<td align="right">0.31243</td>
<td align="right">0.00840</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="right">1000</td>
<td align="right">0.00725</td>
<td align="right">0.00981</td>
<td align="right">0.09631</td>
<td align="right">0.00440</td>
<td align="right">0.09627</td>
<td align="right">0.00439</td>
<td align="right">0.31028</td>
<td align="right">0.00862</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="right">1000</td>
<td align="right">-0.00266</td>
<td align="right">0.00867</td>
<td align="right">0.07521</td>
<td align="right">0.00330</td>
<td align="right">0.07514</td>
<td align="right">0.00331</td>
<td align="right">0.27411</td>
<td align="right">0.00744</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="right">1000</td>
<td align="right">-0.00514</td>
<td align="right">0.00895</td>
<td align="right">0.08002</td>
<td align="right">0.00391</td>
<td align="right">0.07997</td>
<td align="right">0.00391</td>
<td align="right">0.28278</td>
<td align="right">0.00826</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="right">1000</td>
<td align="right">-0.01124</td>
<td align="right">0.00899</td>
<td align="right">0.08081</td>
<td align="right">0.00358</td>
<td align="right">0.08086</td>
<td align="right">0.00358</td>
<td align="right">0.28435</td>
<td align="right">0.00775</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="right">1000</td>
<td align="right">-0.00079</td>
<td align="right">0.00883</td>
<td align="right">0.07805</td>
<td align="right">0.00345</td>
<td align="right">0.07798</td>
<td align="right">0.00345</td>
<td align="right">0.27924</td>
<td align="right">0.00760</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="relative-criteria">Relative Criteria<a class="anchor" aria-label="anchor" href="#relative-criteria"></a>
</h3>
<p>Relative criteria can be useful for describing an estimator’s
performance, especially if the performance varies in proportion to the
true value of the target parameter. It can be only used when <span class="math inline">\(|\theta| &gt; 0\)</span> as we cannot divide by
<span class="math inline">\(0\)</span> <span class="citation">(Morris et
al., 2019)</span>.</p>
<p>To derive the MCSE for relative RMSE, we again used the jack-knife
technique. The formula to calculate relative RMSE is:</p>
<p><span class="math display">\[rRMSE = \sqrt{\frac{(\bar{T} - \theta)^2
+ S_T^2}{\theta^2}}\]</span></p>
<p>The jack-knife RMSE will be calculated as:</p>
<p><span class="math display">\[rRMSE_{(j)}  =
\sqrt{\frac{(\bar{T}_{(j)} - \theta)^2 +
S_{T(j)}^2}{\theta^2}}\]</span></p>
<p>Here <span class="math inline">\(\bar{T}_{(j)}\)</span> and <span class="math inline">\(S^2_{T(j)}\)</span> are calculated as specified
above when we described the algebra trick to estimate these values. The
MCSE is then calculated as specified in the table below.</p>
<p>Table 2 below shows each of the relative performance criteria, its
interpretation, its formal definition, how the criterion is estimated in
a simulation study, and its MCSE formula.</p>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Table 2. Relative Performance Criteria
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Relative Bias
</td>
<td style="text-align:left;">
Relative difference from true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(T) / \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{T} / \theta\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{S_T^2 / (K\theta^2)}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative MSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(T - \theta)^2\right]/
\theta^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{(\bar{T} - \theta)^2 +
S_T^2}{\theta^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{1}{K\theta^2}\left[S_T^4 (k_T -
1) + 4 S_T^3 g_T(\bar{T} - \theta) + 4 S_T^2 (\bar{T} -
\theta)^2\right]}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative RMSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\text{E}\left[(T - \theta)^2\right]/
\theta^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{(\bar{T} - \theta)^2 +
S_T^2}{\theta^2}}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{K - 1}{K} \sum_{j=1}^K
\left(rRMSE_{(j)} - rRMSE)^2\right)}\)</span>
</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>Below, we calculate the relative criteria for the mean difference
estimates. Note that when the mean difference is 0, the relative
measures cannot be calculated and the function returns <code>NA</code>
values. The syntax for <code><a href="../reference/calc_relative.html">calc_relative()</a></code> is similar to the
one that we used earlier for <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code>. The
<code>perfm_criteria</code> argument allows the user to specify which
criteria to evaluate:
<code>perfm_criteria = c("relative bias", "relative mse", "relative rmse")</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using group_modify()</span></span>
<span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"t-test"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">mean_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">mean_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/calc_relative.html">calc_relative</a></span><span class="op">(</span><span class="va">.x</span>, estimates <span class="op">=</span> <span class="va">est</span>, true_param <span class="op">=</span> <span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="3%">
<col width="11%">
<col width="5%">
<col width="10%">
<col width="15%">
<col width="9%">
<col width="14%">
<col width="10%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">mean_diff</th>
<th align="right">K</th>
<th align="right">rel_bias</th>
<th align="right">rel_bias_mcse</th>
<th align="right">rel_mse</th>
<th align="right">rel_mse_mcse</th>
<th align="right">rel_rmse</th>
<th align="right">rel_rmse_mcse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="right">1000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="right">1000</td>
<td align="right">0.98890</td>
<td align="right">0.02069</td>
<td align="right">0.42803</td>
<td align="right">0.00947</td>
<td align="right">0.65424</td>
<td align="right">0.01451</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="right">1000</td>
<td align="right">0.99274</td>
<td align="right">0.00988</td>
<td align="right">0.09771</td>
<td align="right">0.00423</td>
<td align="right">0.31259</td>
<td align="right">0.00679</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="right">1000</td>
<td align="right">1.00363</td>
<td align="right">0.00491</td>
<td align="right">0.02409</td>
<td align="right">0.00219</td>
<td align="right">0.15522</td>
<td align="right">0.00355</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="right">1000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="right">1000</td>
<td align="right">0.98972</td>
<td align="right">0.01789</td>
<td align="right">0.32018</td>
<td align="right">0.00783</td>
<td align="right">0.56585</td>
<td align="right">0.01388</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="right">1000</td>
<td align="right">0.98876</td>
<td align="right">0.00899</td>
<td align="right">0.08094</td>
<td align="right">0.00358</td>
<td align="right">0.28449</td>
<td align="right">0.00631</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="right">1000</td>
<td align="right">0.99961</td>
<td align="right">0.00442</td>
<td align="right">0.01951</td>
<td align="right">0.00172</td>
<td align="right">0.13969</td>
<td align="right">0.00309</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="relative-criteria-for-variance-estimators">Relative Criteria for Variance Estimators<a class="anchor" aria-label="anchor" href="#relative-criteria-for-variance-estimators"></a>
</h3>
<p>Variance estimators are always positive, and so relative criteria are
often used to characterize their performance. For variance estimators,
we have <span class="math inline">\(V\)</span> denoting the sampling
variance of a point estimator <span class="math inline">\(T\)</span>. To
assess the relative criteria for <span class="math inline">\(V\)</span>,
we need to divide it by the true value of the sampling variance of <span class="math inline">\(T\)</span>, <span class="math inline">\(\lambda =
\text{Var}(T)\)</span>, which we may not be able to calculate directly.
In such scenario, we can use the sample variance of <span class="math inline">\(T\)</span> across the replications, <span class="math inline">\(S_T^2\)</span>, to estimate the true sampling
variance.</p>
<p>The relative bias would then be estimated by <span class="math inline">\(rB = \bar{V} / S_T^2\)</span>, the average of the
variance estimates divided by the sample variance of the point
estimates. To estimate MCSE of the relative bias of the variance
estimator, we need to account for the uncertainty in the estimation of
the true sampling variance. One way to do so is to use the jack-knife
technique that we described above, which entails excluding a replicate
<span class="math inline">\(j\)</span> and calculating relative bias
<span class="math inline">\(\bar{V}_{(j)}/ S_{T(j)}^2\)</span>. The
Monte Carlo standard error can then be calculated as:</p>
<p><span class="math display">\[
MCSE\left(rB\right) = \sqrt{\frac{K - 1}{K} \sum_{j=1}^K \left(rB_{(j)}
- rB\right)^2}
\]</span> which can be written as:</p>
<p><span class="math display">\[
MCSE\left(rB\right) = \sqrt{\frac{K - 1}{K} \sum_{j=1}^K
\left(\frac{\bar{V}_{(j)}}{S_{T(j)}^2} - \frac{\bar{V}}{S_T^2}\right)^2}
\]</span></p>
<p>We reformulate the MCSE using some algebra tricks similar to how we
reformulated them for the RMSE MCSE formulas above.</p>
<p><span class="math display">\[
\begin{aligned}
\bar{V}_{(j)} &amp;= \frac{1}{K - 1}\left(K \bar{V} - V_j\right) \\
S_{T(j)}^2 &amp;= \frac{1}{K - 2} \left[(K - 1) S_T^2 - \frac{K}{K -
1}\left(T_j - \bar{T}\right)^2\right]
\end{aligned}
\]</span></p>
<p>Similarly, we can estimate the MCSE of relative MSE and RMSE using
the jack-knife technique. To estimate the MSE we need to estimate <span class="math inline">\(S_{V(j)}^2\)</span>, which represents the sample
variance of the variance estimates leaving replicate <span class="math inline">\(j\)</span> out. We calculate <span class="math inline">\(S_{V(j)}^2\)</span> as</p>
<p><span class="math display">\[S_{V(j)}^2 = \frac{1}{K - 2} \left[(K -
1) S_V^2 - \frac{K}{K - 1}\left(V_j -
\bar{V}\right)^2\right].\]</span></p>
<p>We can then estimate the jack-knife relative MSE and RMSE following
the same logic as we described above and then calculate the MCSE.</p>
<p>Table 3 below lists relative performance measures for variance
estimators.</p>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Table 3. Relative Performance Criteria for Variance Estimators
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Relative Bias
</td>
<td style="text-align:left;">
Relative difference from true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(V) / \lambda\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{V} / S_T^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{K - 1}{K} \sum_{j=1}^K
\left(rB_{(j)} - rB\right)^2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative MSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}\left[(V - \lambda)^2\right]/
\lambda^2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\frac{(\bar{V} - S_T^2)^2 +
S_V^2}{S_T^4}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{K - 1}{K} \sum_{j=1}^K
\left(rMSE_{(j)} - rMSE\right)^2}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Relative RMSE
</td>
<td style="text-align:left;">
Accuracy
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\text{E}\left[(V - \lambda)^2\right]/
\lambda^2}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{(\bar{V} - S_T^2)^2 +
S_V^2}{S_T^4}}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{\frac{K - 1}{K} \sum_{j=1}^K
\left(rRMSE_{(j)} - rRMSE\right)^2}\)</span>
</td>
</tr>
</tbody>
</table>
<p>The function <code><a href="../reference/calc_relative_var.html">calc_relative_var()</a></code> calculates the relative
performance criteria estimates and corresponding jack-knife MCSEs for a
variance estimator. The function requires <code>res_dat</code>, a data
frame or tibble containing simulation results, <code>estimates</code>,
the name of the column containing point estimates,
<code>var_estimates</code>, the name of the column containing the
variance estimates, and <code>perfm_criteria</code>, the criteria to be
evaluated:
<code>perfm_criteria = c("relative bias", "relative mse", "relative rmse")</code>.</p>
<p>Below we demonstrate the use of the <code><a href="../reference/calc_relative_var.html">calc_relative_var()</a></code>
function. The variance estimates are expected to be different when
derived from the conventional t-test as opposed to when they are derived
from the Welch t-test. We group by the sample sizes, mean difference,
and the t-test method. Note the difference between the conventional
t-test and the Welch t-test results, especially when the group sample
sizes are unequal.</p>
<p>If there are any convergence issues with estimation, please again
make sure that the estimation function returns <code>NA</code> values
for the variance estimate and the point estimate. The
<code><a href="../reference/calc_relative_var.html">calc_relative_var()</a></code> function will omit the pair of point
estimate and variance estimate if either value is <code>NA</code> before
calculating the performance measure and MCSE.</p>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">mean_diff</span>, <span class="va">method</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/calc_relative_var.html">calc_relative_var</a></span><span class="op">(</span><span class="va">.x</span>, estimates <span class="op">=</span> <span class="va">est</span>, var_estimates <span class="op">=</span> <span class="va">var</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="2%">
<col width="8%">
<col width="10%">
<col width="4%">
<col width="10%">
<col width="14%">
<col width="9%">
<col width="13%">
<col width="10%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">mean_diff</th>
<th align="left">method</th>
<th align="right">K</th>
<th align="right">rel_bias_var</th>
<th align="right">rel_bias_var_mcse</th>
<th align="right">rel_mse_var</th>
<th align="right">rel_mse_var_mcse</th>
<th align="right">rel_rmse_var</th>
<th align="right">rel_rmse_var_mcse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.99449</td>
<td align="right">0.04264</td>
<td align="right">0.02941</td>
<td align="right">0.00259</td>
<td align="right">0.17148</td>
<td align="right">0.00756</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.99449</td>
<td align="right">0.04264</td>
<td align="right">0.02941</td>
<td align="right">0.00259</td>
<td align="right">0.17148</td>
<td align="right">0.00756</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.93705</td>
<td align="right">0.04202</td>
<td align="right">0.02839</td>
<td align="right">0.00313</td>
<td align="right">0.16849</td>
<td align="right">0.00929</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.93705</td>
<td align="right">0.04202</td>
<td align="right">0.02839</td>
<td align="right">0.00313</td>
<td align="right">0.16849</td>
<td align="right">0.00929</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">1.02571</td>
<td align="right">0.04508</td>
<td align="right">0.03103</td>
<td align="right">0.00534</td>
<td align="right">0.17616</td>
<td align="right">0.01512</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.02571</td>
<td align="right">0.04508</td>
<td align="right">0.03103</td>
<td align="right">0.00534</td>
<td align="right">0.17616</td>
<td align="right">0.01512</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">1.04180</td>
<td align="right">0.04785</td>
<td align="right">0.03211</td>
<td align="right">0.00717</td>
<td align="right">0.17918</td>
<td align="right">0.01990</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.04180</td>
<td align="right">0.04785</td>
<td align="right">0.03211</td>
<td align="right">0.00717</td>
<td align="right">0.17918</td>
<td align="right">0.01990</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">1.02720</td>
<td align="right">0.04555</td>
<td align="right">0.02079</td>
<td align="right">0.00452</td>
<td align="right">0.14420</td>
<td align="right">0.01561</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.25701</td>
<td align="right">0.05583</td>
<td align="right">0.10150</td>
<td align="right">0.03217</td>
<td align="right">0.31859</td>
<td align="right">0.05013</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.96512</td>
<td align="right">0.04765</td>
<td align="right">0.01795</td>
<td align="right">0.00157</td>
<td align="right">0.13398</td>
<td align="right">0.00586</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.18047</td>
<td align="right">0.05831</td>
<td align="right">0.06131</td>
<td align="right">0.02440</td>
<td align="right">0.24760</td>
<td align="right">0.04864</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.95326</td>
<td align="right">0.04270</td>
<td align="right">0.01921</td>
<td align="right">0.00245</td>
<td align="right">0.13859</td>
<td align="right">0.00885</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.16667</td>
<td align="right">0.05225</td>
<td align="right">0.05714</td>
<td align="right">0.02032</td>
<td align="right">0.23905</td>
<td align="right">0.04221</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.98888</td>
<td align="right">0.04413</td>
<td align="right">0.01938</td>
<td align="right">0.00126</td>
<td align="right">0.13919</td>
<td align="right">0.00451</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.21007</td>
<td align="right">0.05409</td>
<td align="right">0.07709</td>
<td align="right">0.02594</td>
<td align="right">0.27765</td>
<td align="right">0.04640</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="hypothesis-testing-and-confidence-intervals">Hypothesis Testing and Confidence Intervals<a class="anchor" aria-label="anchor" href="#hypothesis-testing-and-confidence-intervals"></a>
</h3>
<p>When doing hypothesis tests, we are often interested in whether the
Type 1 error rate is adequately controlled and whether the test has
enough power to detect an effect size of substantive interest. The
rejection rate of a hypothesis test captures the proportion of times the
p-value is below a specified <span class="math inline">\(\alpha\)</span>
level—that is, the proportion of times we reject the null hypothesis.
When the specified effect size is 0, we can examine Type 1 error rates
and when the magnitude of the effect is greater than 0, we can examine
power. We are also interested in confidence interval coverage, the
proportion of intervals that contain the true parameter, and the
interval width, which is an indicator of the precision of the interval
estimator.</p>
<p>Table 4 below presents the performance criteria used to evaluate
hypothesis tests. In the table, let <span class="math inline">\(P_k\)</span> denote the p-value from simulation
replication <span class="math inline">\(k\)</span>, for <span class="math inline">\(k = 1,...,K\)</span>. Suppose that the confidence
intervals are for the target parameter <span class="math inline">\(\theta\)</span> and have coverage level <span class="math inline">\(\beta\)</span>. Let <span class="math inline">\(A_k\)</span> and <span class="math inline">\(B_k\)</span> denote the lower and upper end-points
of the confidence interval from simulation replication <span class="math inline">\(k\)</span>, and let <span class="math inline">\(W_k = B_k − A_k\)</span>, for <span class="math inline">\(k = 1,...,K\)</span>.</p>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Table 4. Hypothesis Testing and Confidence Intervals Performance
Criteria
</caption>
<thead><tr>
<th style="text-align:left;">
Criterion
</th>
<th style="text-align:left;">
Measure
</th>
<th style="text-align:left;">
Definition
</th>
<th style="text-align:left;">
Estimate
</th>
<th style="text-align:left;">
MCSE
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rejection Rate
</td>
<td style="text-align:left;">
Type 1 error or power
</td>
<td style="text-align:left;">
<span class="math inline">\(\rho_\alpha = Pr(P_k) &amp;lt;
\alpha\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(r_\alpha = \frac{1}{K} \sum_{k=1}^K I(P_k
&amp;lt; \alpha)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{r_\alpha(1 - r_\alpha) / K}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Coverage
</td>
<td style="text-align:left;">
Proportion of intervals containing true parameter
</td>
<td style="text-align:left;">
<span class="math inline">\(\omega_\beta = Pr(A \leq \theta \leq
B)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(c_\beta = \frac{1}{K}\sum_{k=1}^K I(A_k \leq
\theta \leq B_k)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{c_\beta (1 - c_\beta) / K}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Width
</td>
<td style="text-align:left;">
Precision
</td>
<td style="text-align:left;">
<span class="math inline">\(\text{E}(W) = \text{E}(B - A)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\bar{W} = \bar{B} - \bar{A}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{S_W^2 / K}\)</span>
</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="example-3">Example<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<p>Below we calculate the rejection rates for the hypothesis tests
conducted using the conventional two-sample t-test and the Welch t-test.
The null hypothesis is that the two groups have the same means. The
<code><a href="../reference/calc_rejection.html">calc_rejection()</a></code> function requires a data frame or tibble
containing simulation results as the first argument. The second
argument, <code>p_values</code>, requires the name of the column
containing p-values. The third argument, <code>alpha</code>, lets the
user specify a value for <span class="math inline">\(\alpha\)</span>.
The default value is set to the conventional 0.05.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using group_modify()</span></span>
<span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">mean_diff</span>, <span class="va">method</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/calc_rejection.html">calc_rejection</a></span><span class="op">(</span><span class="va">.x</span>, p_values <span class="op">=</span> <span class="va">p_val</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">mean_diff</th>
<th align="left">method</th>
<th align="right">K</th>
<th align="right">rej_rate</th>
<th align="right">rej_rate_mcse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.047</td>
<td align="right">0.00669</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.048</td>
<td align="right">0.00676</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.335</td>
<td align="right">0.01493</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.340</td>
<td align="right">0.01498</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.871</td>
<td align="right">0.01060</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.876</td>
<td align="right">0.01042</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">1.000</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.000</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.039</td>
<td align="right">0.00612</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.027</td>
<td align="right">0.00513</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.426</td>
<td align="right">0.01564</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.341</td>
<td align="right">0.01499</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.937</td>
<td align="right">0.00768</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.904</td>
<td align="right">0.00932</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">1.000</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">1.000</td>
<td align="right">0.00000</td>
</tr>
</tbody>
</table>
<p>Below we calculate the confidence interval coverage rates and widths
for the estimates of the mean difference. The
<code><a href="../reference/calc_coverage.html">calc_coverage()</a></code> function requires a data frame or tibble
containing the simulation results as the first argument. The second and
third arguments, <code>lower_bound</code> and <code>upper_bound</code>,
take in the name of the columns that contain the lower and upper bound
estimates of the confidence intervals. The <code>true_param</code>
argument requires the name of the column containing the true parameters.
Like <code><a href="../reference/calc_absolute.html">calc_absolute()</a></code>, <code><a href="../reference/calc_relative.html">calc_relative()</a></code> and
<code><a href="../reference/calc_relative_var.html">calc_relative_var()</a></code>, <code><a href="../reference/calc_coverage.html">calc_coverage()</a></code> also has
an argument, <code>perfm_criteria</code>, where the user can specify
which criteria to evaluate:
<code>perfm_criteria = c("coverage", "width")</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using group_modify()</span></span>
<span><span class="va">welch_res</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>params <span class="op">=</span> <span class="va">mean_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span>, <span class="va">mean_diff</span>, <span class="va">method</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/calc_coverage.html">calc_coverage</a></span><span class="op">(</span><span class="va">.x</span>, lower_bound <span class="op">=</span> <span class="va">lower_bound</span>, upper_bound <span class="op">=</span> <span class="va">upper_bound</span>, true_param <span class="op">=</span> <span class="va">params</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="3%">
<col width="13%">
<col width="17%">
<col width="6%">
<col width="11%">
<col width="18%">
<col width="10%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">n1</th>
<th align="right">n2</th>
<th align="right">mean_diff</th>
<th align="left">method</th>
<th align="right">K</th>
<th align="right">coverage</th>
<th align="right">coverage_mcse</th>
<th align="right">width</th>
<th align="right">width_mcse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.953</td>
<td align="right">0.00669</td>
<td align="right">1.25266</td>
<td align="right">0.00343</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.952</td>
<td align="right">0.00676</td>
<td align="right">1.24697</td>
<td align="right">0.00338</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.944</td>
<td align="right">0.00727</td>
<td align="right">1.25800</td>
<td align="right">0.00336</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">0.5</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.943</td>
<td align="right">0.00733</td>
<td align="right">1.25223</td>
<td align="right">0.00332</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.953</td>
<td align="right">0.00669</td>
<td align="right">1.25741</td>
<td align="right">0.00339</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">1.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.952</td>
<td align="right">0.00676</td>
<td align="right">1.25169</td>
<td align="right">0.00335</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.959</td>
<td align="right">0.00627</td>
<td align="right">1.25859</td>
<td align="right">0.00335</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">50</td>
<td align="right">2.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.958</td>
<td align="right">0.00634</td>
<td align="right">1.25287</td>
<td align="right">0.00331</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.961</td>
<td align="right">0.00612</td>
<td align="right">1.09943</td>
<td align="right">0.00241</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.973</td>
<td align="right">0.00513</td>
<td align="right">1.21433</td>
<td align="right">0.00288</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.952</td>
<td align="right">0.00676</td>
<td align="right">1.09938</td>
<td align="right">0.00234</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">0.5</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.972</td>
<td align="right">0.00522</td>
<td align="right">1.21412</td>
<td align="right">0.00276</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.940</td>
<td align="right">0.00751</td>
<td align="right">1.09791</td>
<td align="right">0.00239</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">1.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.963</td>
<td align="right">0.00597</td>
<td align="right">1.21280</td>
<td align="right">0.00283</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="left">Welch t-test</td>
<td align="right">1000</td>
<td align="right">0.951</td>
<td align="right">0.00683</td>
<td align="right">1.09886</td>
<td align="right">0.00245</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">70</td>
<td align="right">2.0</td>
<td align="left">t-test</td>
<td align="right">1000</td>
<td align="right">0.971</td>
<td align="right">0.00531</td>
<td align="right">1.21376</td>
<td align="right">0.00289</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="how-to-evaluate-mcse">How to Evaluate MCSE<a class="anchor" aria-label="anchor" href="#how-to-evaluate-mcse"></a>
</h2>
<p>Generally, the associated MCSE should be small compared to the
performance measure. Below is an example from <span class="citation">Frane (2015)</span> of how to write up MCSE results as
part of simulation study results. <span class="citation">Frane
(2015)</span> compared various methods to control Type 1 error rates
when conducting analysis on multiple outcome variables. In describing
the simulation results, he wrote:</p>
<blockquote>
<p>Only Bonferroni and MP strictly controlled the PFER; the observed
maximum PFER was 0.050 for Bonferroni, 0.051 for Sidák, 0.061 for Holm,
0.100 for Hochberg, and 0.050 for MP (estimated SE ≤ 0.0002 for all
estimates).</p>
</blockquote>
<p>The PFER refers to per family error rate, the expected number of Type
1 errors out of <span class="math inline">\(m\)</span> comparisons. MP
refers to multivariate analysis of variance (MANOVA) protected tests.
The SE refers to the MCSE. The number of replications was 1,000,000 in
<span class="citation">Frane (2015)</span>. We note that the number is
quite high and generally 1,000 to 10,000 replications are enough. The
resulting MCSEs in <span class="citation">Frane (2015)</span>,
therefore, are exceedingly small compared to the values for PFER.</p>
<p>For more information for performance criteria and MCSE, we recommend
<span class="citation">Morris et al. (2019)</span>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-efron1981jackknife" class="csl-entry">
Efron, B., &amp; Stein, C. (1981). The jackknife estimate of variance.
<em>The Annals of Statistics</em>, 586–596.
</div>
<div id="ref-frane2015power" class="csl-entry">
Frane, A. V. (2015). Power and type i error control for univariate
comparisons in multivariate two-group designs. <em>Multivariate
Behavioral Research</em>, <em>50</em>(2), 233–247.
</div>
<div id="ref-morris2019using" class="csl-entry">
Morris, T. P., White, I. R., &amp; Crowther, M. J. (2019). Using
simulation studies to evaluate statistical methods. <em>Statistics in
Medicine</em>, <em>38</em>(11), 2074–2102.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D.,
François, R., … Yutani, H. (2019). Welcome to the <span class="nocase">tidyverse</span>. <em>Journal of Open Source
Software</em>, <em>4</em>(43), 1686. <a href="https://doi.org/10.21105/joss.01686" class="external-link">https://doi.org/10.21105/joss.01686</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://meghapsimatrix.com/" class="external-link">Megha Joshi</a>, <a href="https://www.jepusto.com/" class="external-link">James Pustejovsky</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
